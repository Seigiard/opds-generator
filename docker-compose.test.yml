services:
  test:
    build:
      context: .
      target: development
    volumes:
      - ./src:/app/src:ro
      - ./test:/app/test:ro
      - ./files:/app/files:ro
      - ./bunfig.toml:/app/bunfig.toml:ro
    environment:
      - LOG_LEVEL=warn
    # Run all test folders except e2e (e2e requires running container, use bun run test:e2e)
    command: ["sh", "-c", "bun test $(find test -type d -mindepth 1 -maxdepth 1 ! -name e2e)"]
